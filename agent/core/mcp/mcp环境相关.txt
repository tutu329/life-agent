一、安装nginx（用于将mcp的http映射到https，openai的response api必须mcp开https）
    # 更新包索引
    sudo apt update(注意要关vpn，用清华源的缘故)
    # 安装 nginx
    sudo apt install -y nginx
    # 设置开机自启
    sudo systemctl enable nginx
    # 启动服务
    sudo systemctl start nginx
    # 查看状态
    systemctl status nginx

2、nginx配置(将mcp的8100端口映射为https)
1）生成fullchain(根据测试：powerai_public.crt 与 powerai.key 匹配（两者哈希一致），powerai_chain.crt 是中间证书链（与私钥不匹配是正常的）)
    cd /home/tutu/ssl
    sudo sh -c "cat powerai_public.crt powerai_chain.crt > powerai_fullchain.pem"

2）sudo vi /etc/nginx/sites-available/powerai_mcp.conf
server {
    listen 8100 ssl http2;
    server_name powerai.cc;

    ssl_certificate     /home/tutu/ssl/powerai_fullchain.pem;  # 建议为 full chain
    ssl_certificate_key /home/tutu/ssl/powerai.key;

    # ---- SSE 关键设置：禁用缓冲、长连接、充足超时 ----
    proxy_http_version 1.1;
    proxy_buffering off;
    proxy_request_buffering off;
    proxy_read_timeout 1h;
    proxy_send_timeout 1h;

    # SSE 订阅流：/sse
    location /sse {
        proxy_set_header Host $host;
        proxy_set_header Connection "";
        proxy_set_header Cache-Control "no-cache";
        proxy_pass http://127.0.0.1:8100;
    }

    # 发送消息：/message
    location /message {
        proxy_set_header Host $host;
        proxy_pass http://127.0.0.1:8100;
    }

    # （可选）如果改用 Streamable HTTP：
    # location /mcp {
    #     proxy_set_header Host $host;
    #     proxy_pass http://127.0.0.1:8100;
    # }
}

# 可选：80 重定向到 443
# server {
#     listen 80;
#     server_name powerai.cc;
#     return 301 https://$host$request_uri;
# }

3）链接
    sudo ln -s /etc/nginx/sites-available/powerai_mcp.conf /etc/nginx/sites-enabled/

4）检查配置是否正确
    sudo nginx -t

5）重启nginx
    sudo systemctl reload nginx
    systemctl status nginx

二、mcp
    npx supergateway --stdio "npx @modelcontextprotocol/server-everything" --port 8100 --sse

三、测试